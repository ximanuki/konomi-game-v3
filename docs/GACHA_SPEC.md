# 🎰 ガチャシステム詳細設計書

**バージョン:** 1.0  
**設計思想:** 6歳が「うわー！！」と叫ぶガチャ体験  
**参考:** ソシャゲ演出を子供向けに翻訳

---

## 🎯 ガチャの本質：なぜ人はガチャを引きたくなるのか

### ソシャゲガチャの中毒性要素

1. **予測不可能性** - 何が出るかわからないドキドキ
2. **段階的期待** - 「虹色だ！」→「金色だ！」→「キター！」
3. **所有の喜び** - 自分だけのコレクション
4. **希少性** - レアなものを持っている優越感
5. **演出の爽快感** - 派手な光と音の快感

### 6歳向けへの翻訳

| ソシャゲ要素 | 子供向け翻訳 | このアプリでの実装 |
|-------------|-------------|------------------|
| SSR/SR/R | ⭐️の数（1〜3つ） | キラキラどうぶつ / にじいろスタンプ |
| 課金石 | キラキラ（ゲームで稼ぐ） | 完全無料、時間で回復 |
| 天井システム | 必ず良いのが出る安心感 | 10回で確定レア |
| 限定ガチャ | 季節のおともだち | 春夏秋冬イベント |
| すり抜け（ハズレ） | 存在しない | 全部かわいい、全部嬉しい |

---

## 🎪 ガチャの種類

### 1. ふしぎなたまご（メインガチャ）

**コンセプト:** どうぶつのたまごを孵化させる

```
たまごを選ぶ → タップして温める → ひび割れる → ぱかっと割れる → どうぶつ誕生！
```

| レア度 | たまごの見た目 | 確率 | 演出時間 |
|--------|---------------|------|---------|
| ⭐️ | 白いたまご | 60% | 2.0秒 |
| ⭐️⭐️ | 金色のたまご | 30% | 3.5秒 |
| ⭐️⭐️⭐️ | にじいろたまご | 10% | 5.0秒 |

**必要コスト:** 30キラキラ / 1回

---

### 2. まほうのスタンプガチャ

**コンセプト:** おえかきで使えるスタンプを集める

```
ふうせんをタップ → 割れる → スタンプ出現！
```

| レア度 | ふうせんの色 | 確率 | 内容 |
|--------|------------|------|------|
| ⭐️ | ピンク | 65% | 基本スタンプ |
| ⭐️⭐️ | 金 | 25% | キラキラスタンプ |
| ⭐️⭐️⭐️ | にじいろ | 10% | 動くスタンプ |

**必要コスト:** 20キラキラ / 1回

---

### 3. きせかえガチャ（おようふくBOX）

**コンセプト:** プレゼントボックスを開ける

```
プレゼントをタップ → リボンがほどける → 箱が開く → おようふく出現！
```

| レア度 | 箱の見た目 | 確率 | 内容 |
|--------|----------|------|------|
| ⭐️ | ピンクの箱 | 60% | ふつうのおようふく |
| ⭐️⭐️ | 金の箱 | 30% | キラキラおようふく |
| ⭐️⭐️⭐️ | にじの箱 | 10% | まほうのおようふく |

**必要コスト:** 25キラキラ / 1回

---

## 🎬 演出タイムライン詳細

### 基本演出フロー（ふしぎなたまご）

```
【0.0秒】ガチャボタンタップ
     ↓
【0.0〜0.3秒】ボタンが沈む + SE「ポコン」+ 軽振動
     ↓
【0.3〜0.8秒】画面が少し暗くなる（期待感を煽る）
     ↓
【0.8〜1.2秒】たまご登場（下から上昇）
     ↓
【1.2〜2.0秒】たまご判定演出（ここで分岐）
     ↓
【レア度別演出】
     ↓
【最終】どうぶつ登場 + 名前表示 + 図鑑登録
```

---

## ⭐️ レア度別演出詳細

### ⭐️ ノーマル（白いたまご）

**総演出時間:** 2.0秒

```
【0.0〜0.5秒】
- たまご登場（白、ほんのり光る）
- SE: 「ぽわん」
- 振動: なし

【0.5〜1.0秒】
- たまごが3回揺れる
- 揺れ幅: ±5px, 周期: 0.15秒
- SE: 「コツコツコツ」

【1.0〜1.5秒】
- ひび割れ出現
- パーティクル: 白い粒 5個
- SE: 「パリッ」
- 振動: 10ms

【1.5〜2.0秒】
- たまご割れる
- 中からどうぶつがぴょんと出る
- パーティクル: 星 10個
- SE: 「ぱかっ！」+「ぴょん」
- 振動: 20ms
- 背景: 白いフラッシュ（0.1秒）
```

---

### ⭐️⭐️ レア（金色のたまご）

**総演出時間:** 3.5秒

```
【0.0〜0.8秒】
- たまご登場（金色、キラキラ光る）
- 背景: 薄い金色のオーラ
- SE: 「キラーン」
- 振動: 15ms
- 画面: ゆっくり縦揺れ（3px）

【0.8〜1.5秒】
- 「おおっ！」テキスト表示（画面上部）
- たまごが輝きを増す
- パーティクル: 金の粒 20個（放射状）
- SE: 「シャラララ〜」（上昇音）

【1.5〜2.2秒】
- たまごが5回揺れる（激しく）
- 揺れ幅: ±10px, 周期: 0.12秒
- 金色の光が脈動
- SE: 「コンコンコンコンコン」
- 振動: [10, 30, 10, 30, 10]ms パターン

【2.2〜2.8秒】
- 大きなひび割れ
- パーティクル: 金の破片 15個
- SE: 「バリバリッ！」
- 振動: 30ms
- 画面: 金色フラッシュ

【2.8〜3.5秒】
- たまご爆発的に割れる
- どうぶつ登場（少し大きめ、輝いている）
- パーティクル: 金の星 30個 + 紙吹雪 20個
- SE: 「バーン！」+「キラキラキラ〜」+ どうぶつ鳴き声
- 振動: [30, 50, 30]ms パターン
- 背景: 金色のオーラが広がる
```

---

### ⭐️⭐️⭐️ 超レア（にじいろたまご）

**総演出時間:** 5.0秒（クライマックス演出）

```
【0.0〜0.5秒】
- 画面が一瞬暗くなる（期待感MAX）
- SE: 「ドドドド...」（低音）
- 振動: 微弱な連続振動

【0.5〜1.2秒】
- 画面下から虹色の光が上昇
- たまご登場（虹色に輝く、回転しながら）
- SE: 「ファーン！」（壮大なファンファーレ開始）
- 振動: 20ms

【1.2〜2.0秒】
- 「すごい！！」大文字テキスト（ドーンと登場）
- 虹色オーラが画面全体に広がる
- パーティクル: 虹色の粒 50個（螺旋状に上昇）
- SE: ファンファーレ継続
- 振動: [15, 30, 15, 30, 15]ms

【2.0〜3.0秒】
- たまごが激しく震える
- 虹色の光が脈動（呼吸するように）
- SE: 「キラキラキラキラ〜」（加速）
- 振動: 連続パターン
- 画面: 縦横揺れ（5px）

【3.0〜3.8秒】
- たまご全体にひび割れ（放射状）
- 隙間から虹色の光が漏れる
- SE: 「バリバリバリッ！！」
- 振動: 50ms（強め）
- 画面: 虹色フラッシュ

【3.8〜4.5秒】
- たまご大爆発
- 画面全体が虹色に
- どうぶつ登場（特大サイズ、後光あり）
- パーティクル: 
  - 虹色の星 50個
  - 金の紙吹雪 30個
  - ハート 20個
- SE: 「バーーン！！」+「ファンファーレ最高潮」+ 特別鳴き声
- 振動: [50, 30, 50, 30, 50]ms

【4.5〜5.0秒】
- 「でんせつの○○げっと！」テキスト（虹色で輝く）
- どうぶつがかわいいポーズ
- パーティクルが周囲を漂う
- BGM: 短い勝利ジングル
- 図鑑登録演出へ遷移
```

---

## 🎨 視覚演出パラメータ

### カラーコード

```css
/* ノーマル */
--normal-egg-base: #FFFFFF;
--normal-egg-glow: rgba(255, 255, 255, 0.5);
--normal-flash: rgba(255, 255, 255, 0.8);

/* レア */
--rare-egg-base: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
--rare-egg-glow: rgba(255, 215, 0, 0.6);
--rare-particle: #FFD700;
--rare-flash: rgba(255, 215, 0, 0.8);

/* 超レア */
--legendary-egg-base: linear-gradient(
  135deg,
  #FF6B6B 0%,    /* 赤 */
  #FFE66D 17%,   /* 黄 */
  #4ECDC4 33%,   /* 緑 */
  #45B7D1 50%,   /* 水色 */
  #96E6A1 67%,   /* 黄緑 */
  #DDA0DD 83%,   /* 紫 */
  #FF6B6B 100%   /* 赤（ループ用） */
);
--legendary-glow: rgba(255, 215, 0, 0.8);
```

### パーティクル設定

```javascript
const PARTICLE_CONFIG = {
  normal: {
    count: 10,
    colors: ['#FFFFFF', '#FFFACD', '#FFF5EE'],
    size: { min: 4, max: 8 },      // px
    speed: { min: 100, max: 200 }, // px/秒
    lifetime: 600,                  // ms
    gravity: 50                     // px/秒²
  },
  rare: {
    count: 30,
    colors: ['#FFD700', '#FFA500', '#FFFF00'],
    size: { min: 6, max: 12 },
    speed: { min: 150, max: 300 },
    lifetime: 800,
    gravity: 30
  },
  legendary: {
    count: 50,
    colors: ['#FF6B6B', '#FFE66D', '#4ECDC4', '#45B7D1', '#96E6A1', '#DDA0DD'],
    size: { min: 8, max: 16 },
    speed: { min: 200, max: 400 },
    lifetime: 1200,
    gravity: 20,
    trail: true  // 軌跡を残す
  }
};
```

### 画面揺れ設定

```javascript
const SHAKE_CONFIG = {
  light: {
    intensity: 3,    // px
    duration: 100,   // ms
    frequency: 50    // Hz
  },
  medium: {
    intensity: 5,
    duration: 200,
    frequency: 40
  },
  heavy: {
    intensity: 8,
    duration: 300,
    frequency: 30
  },
  epic: {  // 超レア用
    intensity: 10,
    duration: 500,
    frequency: 25,
    pattern: 'earthquake'  // 特殊パターン
  }
};
```

---

## 🔊 サウンド設計

### SE一覧

| SE名 | 用途 | 長さ | 音色 |
|------|------|------|------|
| tap_gacha | ガチャボタン押下 | 0.1秒 | ポコン（木琴） |
| egg_appear | たまご登場 | 0.3秒 | ぽわん（マリンバ） |
| egg_shake | たまご揺れ | 0.1秒 | コツ（木） |
| crack_small | ひび割れ（小） | 0.2秒 | パリッ |
| crack_large | ひび割れ（大） | 0.3秒 | バリバリッ |
| hatch_normal | 孵化（ノーマル） | 0.5秒 | ぱかっ + ぴょん |
| hatch_rare | 孵化（レア） | 0.8秒 | バーン + キラキラ |
| hatch_legendary | 孵化（超レア） | 1.2秒 | 大爆発 + ファンファーレ |
| sparkle_loop | キラキラ音（ループ） | 2.0秒 | シャラララ |
| fanfare_rare | レアファンファーレ | 1.5秒 | トランペット風 |
| fanfare_legendary | 超レアファンファーレ | 3.0秒 | オーケストラ風 |

### 音の重ね方

```javascript
// 超レア演出時の音の重ね方
const LEGENDARY_AUDIO_TIMELINE = [
  { time: 0,    se: 'rumble',           volume: 0.4 },
  { time: 500,  se: 'fanfare_legendary', volume: 0.7 },
  { time: 1200, se: 'sparkle_loop',      volume: 0.5 },
  { time: 3000, se: 'crack_large',       volume: 0.8 },
  { time: 3800, se: 'hatch_legendary',   volume: 1.0 },
  { time: 4200, se: 'victory_jingle',    volume: 0.6 }
];
```

---

## 📳 振動パターン

```javascript
const VIBRATION_PATTERNS = {
  // ガチャボタン押下
  tap: [10],
  
  // ノーマル孵化
  normal_hatch: [20],
  
  // レア期待演出
  rare_anticipation: [10, 30, 10, 30, 10],
  
  // レア孵化
  rare_hatch: [30, 50, 30],
  
  // 超レア期待演出（徐々に強く）
  legendary_buildup: [
    10, 50,   // 弱
    15, 40,   // やや弱
    20, 30,   // 中
    30, 20,   // やや強
    50, 10,   // 強
  ],
  
  // 超レア孵化
  legendary_hatch: [50, 30, 50, 30, 50, 30, 100]
};
```

---

## 🎮 ガチャUI設計

### ガチャ画面レイアウト

```
┌─────────────────────────────────────────┐
│ ←       ふしぎなたまご        ☆ 450   │ ヘッダー
├─────────────────────────────────────────┤
│                                         │
│         🥚  🥚  🥚                      │ たまごのプレビュー
│        （3つのたまご表示）               │ （何が出るかはわからない）
│                                         │
│    ┌─────────────────────────────┐      │
│    │                             │      │
│    │      孵化エリア             │      │ メイン演出エリア
│    │    （ここでたまごが孵る）     │      │ 300×300px
│    │                             │      │
│    └─────────────────────────────┘      │
│                                         │
│         でてくるどうぶつ                 │ 排出一覧ボタン
│            📖                           │
│                                         │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐    │
│  │    🥚 たまごをかう！            │    │ ガチャボタン
│  │       30 ☆                     │    │ 80×60px
│  └─────────────────────────────────┘    │
│                                         │
│  ┌─────────────────────────────────┐    │
│  │    🎁 10れんガチャ              │    │ 10連ボタン
│  │      270 ☆（10%OFF）           │    │
│  └─────────────────────────────────┘    │
└─────────────────────────────────────────┘
```

### ガチャボタンの演出

```css
/* ガチャボタン - 押したくなるデザイン */
.gacha-button {
  width: 280px;
  height: 70px;
  border-radius: 35px;
  background: linear-gradient(180deg, #FF69B4 0%, #FF1493 100%);
  box-shadow: 
    0 6px 0 #C71585,
    0 8px 20px rgba(255, 20, 147, 0.4);
  border: 4px solid white;
  
  /* 常にぷるぷる揺れる */
  animation: button-pulse 1.5s ease-in-out infinite;
}

@keyframes button-pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.03); }
}

/* ボタンにキラキラエフェクト */
.gacha-button::before {
  content: '';
  position: absolute;
  top: -5px;
  left: -5px;
  right: -5px;
  bottom: -5px;
  background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}
```

---

## 🔮 10連ガチャ演出

### 特別仕様

- 10回分を連続で見せる（スキップ可能）
- **確定枠:** 10回目は⭐️⭐️以上確定
- **サプライズ:** たまに「にじいろフィーバー」で全部⭐️⭐️以上

### 演出フロー

```
【開始】
画面全体に10個のたまごが並ぶ
     ↓
【1〜9回目】
各たまごが順番に孵化（0.8秒/個）
スキップボタンで一括孵化可能
     ↓
【10回目】
画面中央に大きく表示
確定レア以上なので、最低でもレア演出
     ↓
【結果発表】
全10体がずらっと並ぶ
レア度が高い順にソート
「○○と○○がなかまになった！」
```

---

## 🎁 天井システム（やさしい保証）

### 6歳向け「かならずいいのがでる」システム

```javascript
const PITY_SYSTEM = {
  // 30回引いても⭐️⭐️⭐️が出ない場合、次は確定
  legendary_pity: 30,
  
  // 10連で必ず⭐️⭐️以上が1体
  ten_pull_guarantee: true,
  
  // 毎日1回無料ガチャ
  daily_free: true,
  
  // 初回は⭐️⭐️確定
  first_time_bonus: 'rare_guaranteed'
};
```

---

## 🐾 どうぶつデータ例

```javascript
const ANIMALS = {
  normal: [
    { id: 'rabbit_white', name: 'しろうさぎ', stars: 1, sound: 'pyonpyon' },
    { id: 'cat_orange', name: 'みけねこ', stars: 1, sound: 'nyaa' },
    { id: 'dog_shiba', name: 'しばいぬ', stars: 1, sound: 'wan' },
    { id: 'hamster', name: 'ハムスター', stars: 1, sound: 'kyukyu' },
    // ... 20種類
  ],
  rare: [
    { id: 'rabbit_gold', name: 'きんいろうさぎ', stars: 2, sound: 'pyonpyon_sparkle' },
    { id: 'cat_princess', name: 'おひめさまねこ', stars: 2, sound: 'nyaa_elegant' },
    { id: 'penguin_baby', name: 'あかちゃんペンギン', stars: 2, sound: 'pii' },
    // ... 12種類
  ],
  legendary: [
    { id: 'unicorn', name: 'ユニコーン', stars: 3, sound: 'neigh_magical', special: true },
    { id: 'phoenix_baby', name: 'あかちゃんフェニックス', stars: 3, sound: 'chirp_fire', special: true },
    { id: 'dragon_cute', name: 'ドラゴンのあかちゃん', stars: 3, sound: 'roar_cute', special: true },
    { id: 'fairy_flower', name: 'おはなのようせい', stars: 3, sound: 'rin', special: true },
    // ... 5種類（超レア）
  ]
};
```

---

## 📊 演出成功指標

| 指標 | 目標値 | 計測方法 |
|------|--------|---------|
| 「うわー！」発声 | ⭐️⭐️⭐️で90%以上 | 観察 |
| ガチャボタン再タップ | 80%が2回以上引く | ログ |
| 演出スキップ率 | 10%以下 | ログ |
| 画面を親に見せる | ⭐️⭐️⭐️で70%以上 | 観察 |

---

## ✅ 実装チェックリスト

### Phase 1: 基本機能
- [ ] ガチャ画面UI
- [ ] たまご登場アニメーション
- [ ] レア度判定ロジック
- [ ] 基本的な孵化演出

### Phase 2: 演出強化
- [ ] レア度別演出分岐
- [ ] パーティクルシステム
- [ ] 画面揺れ実装
- [ ] 振動パターン

### Phase 3: サウンド
- [ ] SE制作・実装
- [ ] 音の重ね再生
- [ ] ファンファーレ

### Phase 4: 10連・天井
- [ ] 10連ガチャ演出
- [ ] 天井システム
- [ ] 毎日無料ガチャ

---

**この演出で、このみちゃんは「もういっかいひきたい！」と叫ぶはず 🥚✨**
