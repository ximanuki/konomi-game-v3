# 🎨 まほうのにわ - UI/UX仕様書 v3.1

**バージョン:** 3.1（全面改訂）  
**コンセプト:** 「世界に入り込む」没入感UI

---

## 🎯 UI設計の核心

### 従来のゲームアプリUI vs まほうのにわ

```
❌ 従来: メニュー → ゲーム選択 → プレイ → 結果 → メニューに戻る
⭕ まほうのにわ: 世界に入る → 世界の中で遊ぶ → 世界に居続ける
```

**UIは「邪魔しない」が最優先**

庭を見ている時、UIが視界を遮らない。
操作する時だけ必要なものが現れる。

---

## 📱 画面構成

### メイン画面（庭ビュー）

```
┌─────────────────────────────────────────┐
│                                    ⚙️ │ ← 設定（右上・小さく）
│                                         │
│                                         │
│           🌳    🌷🌷                    │
│        🏠     🐰          🌸🌸          │ ← 庭（全画面）
│     🌷    🌲       🦋                   │
│                 💧                      │
│        🌻🌻                             │
│                                         │
│                                         │
├─────────────────────────────────────────┤
│  📮   🌱   👥   📖            🔍       │ ← ナビ（下部・半透明）
└─────────────────────────────────────────┘
   ポスト たね 住人 図鑑           ズーム
```

### 設計原則

1. **庭が主役** - 90%以上が庭の表示に使われる
2. **UI は脇役** - 半透明、必要時のみ表示
3. **タップで世界と対話** - 庭の要素を直接タップ

---

## 🌳 インタラクション設計

### タップで世界と対話

| タップ対象 | 反応 | 効果 |
|-----------|------|------|
| 土（空き地） | 「植えますか？」 | たね選択画面 |
| 植物（水やり可） | じょうろが出る | 水やりモード |
| 植物（成長中） | ゆらゆら揺れる | かわいい反応 |
| 植物（完成） | キラキラ + 情報 | 図鑑カード表示 |
| 住人 | 吹き出し | 会話 or おつかい |
| 建物 | ドアが開く | 中に入れる（将来） |
| 地面（キラキラ） | スコップ | たからさがし |

### ジェスチャー

| ジェスチャー | 効果 |
|-------------|------|
| タップ | 選択、決定 |
| スワイプ（庭） | 庭を移動 |
| ピンチ | ズームイン/アウト |
| 長押し | なし（6歳には難しい） |
| ダブルタップ | なし |

**すべてタップとスワイプで完結**

---

## 🌱 たね植えフロー

### 1. 土をタップ

```
┌─────────────────────────────────────────┐
│                                         │
│           ここに うえる？               │
│                                         │
│         ┌─────────────────┐             │
│         │  🌱  うえる！   │             │ ← 大きなボタン
│         └─────────────────┘             │
│                                         │
│             やめる                      │ ← テキストリンク
│                                         │
└─────────────────────────────────────────┘
```

### 2. たね選択

```
┌─────────────────────────────────────────┐
│           たねを えらぼう               │
│                                         │
│  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐       │
│  │ 🟢  │ │ 🟤  │ │ 🩷  │ │ 🔵  │ ←→    │ ← 横スクロール
│  │ x5  │ │ x3  │ │ x2  │ │ x1  │       │
│  └─────┘ └─────┘ └─────┘ └─────┘       │
│                                         │
│  みどりのたね                           │
│  おはなや くさが そだつよ               │
│                                         │
└─────────────────────────────────────────┘
```

### 3. 植える演出

```
タップ → たねが飛んでいく → 土にささる → 芽が出る → 完了！
         (0.3秒)           (0.2秒)      (0.3秒)
```

**演出はスキップ不可だが短い**

---

## 💧 みずやりフロー

### 1. 植物タップでじょうろ出現

```
┌─────────────────────────────────────────┐
│                                         │
│                    🚿                   │ ← じょうろ（ドラッグ可）
│                                         │
│           🌱💧    🌿    🌸              │
│                                         │
│  水やりちゅう...                        │
│  ━━━━━━━━░░░░░░░░░░ 3/8                 │ ← 進捗バー
│                                         │
│         ┌─────────────────┐             │
│         │  ✓ おわり！    │             │
│         └─────────────────┘             │
│                                         │
└─────────────────────────────────────────┘
```

### 2. 水やり操作

**方法A:** じょうろを植物にドラッグ
**方法B:** 植物を順番にタップ

どちらでも良い。6歳の子は好きな方を自然に選ぶ。

### 3. 完了演出

```
全部に水やり完了 → 「かんぺき！」の文字 → 植物が一斉にゆらゆら → キラキラエフェクト
```

---

## 🐰 住人との交流UI

### 住人をタップ

```
┌─────────────────────────────────────────┐
│                                         │
│         🐰「こんにちは！」              │ ← 吹き出し
│                                         │
│                                         │
│    ┌────────────────────────────────┐   │
│    │  🐰 うさぎのミミ               │   │
│    │  ♥️♥️♥️♡♡ なかよし 60%          │   │
│    │                                │   │
│    │  [なでる]  [プレゼント]        │   │ ← アクションボタン
│    └────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

### おつかい（クエスト）表示

住人の上に「！」がある時：

```
┌─────────────────────────────────────────┐
│                                         │
│    🐰「にんじんが たべたいなぁ」        │
│                                         │
│    ┌────────────────────────────────┐   │
│    │  おつかい                      │   │
│    │                                │   │
│    │  🥕 にんじんを そだてよう      │   │
│    │                                │   │
│    │  おれい: 🩷たね x2             │   │ ← 報酬が見える
│    │                                │   │
│    │        [うけとる！]            │   │
│    └────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

---

## 📮 デイリーボーナスUI

### ポストの演出

アプリ起動時、ポストが揺れている

```
┌─────────────────────────────────────────┐
│                                         │
│              📮✨                       │ ← ポストがキラキラ揺れる
│             タップ！                    │
│                                         │
└─────────────────────────────────────────┘
```

### ボーナス表示

```
┌─────────────────────────────────────────┐
│                                         │
│            🎁 プレゼント！              │
│                                         │
│         3にちれんぞく ログイン！         │
│                                         │
│              🌱🌱🌱                      │ ← たねが飛び出す
│            たね x3 ゲット！              │
│                                         │
│         ┌─────────────────┐             │
│         │   やったー！    │             │
│         └─────────────────┘             │
│                                         │
│    あしたは... 🌱🌱🌱🌱 ！              │ ← 明日の予告
│                                         │
└─────────────────────────────────────────┘
```

---

## 📖 図鑑UI

### 図鑑メイン

```
┌─────────────────────────────────────────┐
│ ←  ずかん                              │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐       │
│  │🌸    │ │🐰   │ │🏠   │ │ ❓  │       │
│  │おはな│ │どうぶつ│ │たてもの│ │ひみつ│       │
│  │12/30 │ │8/20  │ │5/15 │ │??/?? │       │
│  └─────┘ └─────┘ └─────┘ └─────┘       │
│                                         │
│  ━━━━━━━━━━━━░░░░░ 35%                  │
│  あと すこしで ごほうび！               │
│                                         │
└─────────────────────────────────────────┘
```

### 図鑑詳細（未発見）

```
┌─────────────────────────────────────────┐
│ ←  おはなずかん                        │
├─────────────────────────────────────────┤
│                                         │
│  🌷 🌻 🌸 ❓ ❓ ❓ ❓ ❓                  │
│  🌹 ❓ ❓ ❓ ❓ ❓ ❓ ❓                  │ ← シルエット
│  ❓ ❓ ❓ ❓ ❓ ❓ ❓ ❓                  │
│                                         │
│            12 / 30                      │
│                                         │
└─────────────────────────────────────────┘
```

**シルエット表示で「集めたい！」欲求を刺激**

---

## 🗺️ エリア移動UI

### 現在地表示

画面端に矢印が出る：

```
┌─────────────────────────────────────────┐
│                                    →   │ ← もりへ
│                                         │
│                                         │
│           （現在の庭）                  │
│                                         │
│                                         │
│ ↓                                       │ ← みずうみへ
└─────────────────────────────────────────┘
```

### エリア移動

矢印をタップ or 画面端にスワイプ

```
現在の庭 → (スライドアニメーション) → 新しいエリア
```

**シームレスに繋がっている感覚**

---

## 🎨 ビジュアルスタイル

### 世界観

| 要素 | スタイル |
|------|---------|
| 全体 | 絵本のような水彩タッチ |
| 輪郭 | 柔らかい線（硬い線なし） |
| 影 | 淡い、やわらかい |
| 色 | パステル基調、彩度控えめ |

### カラーパレット（改訂）

```
背景:     #F5F0E6 (暖かいクリーム) - 紙の質感
草地:     #A8D5A2 (やわらかい緑)
土:       #D4A574 (明るい茶色)
空:       #B8D4E8 (淡い水色)
夕焼け:   #F5C6A5 (優しいオレンジ)
夜:       #2C3E50 (深い紺) + 星
```

### アニメーションの質感

| 対象 | アニメーション |
|------|---------------|
| 植物 | ゆらゆら揺れる（風） |
| 住人 | ぴょこぴょこ歩く |
| 水 | きらきら光る |
| 雲 | ゆっくり流れる |
| 全体 | 常に何かが動いている |

**「生きている世界」の演出**

---

## 🔘 ボタンデザイン（改訂）

### メインアクションボタン

```css
.btn-main {
  /* 形状 */
  min-width: 200px;
  height: 64px;
  border-radius: 32px;  /* 完全な丸角 */
  
  /* 色 */
  background: linear-gradient(180deg, #7BC47F 0%, #4A9F4E 100%);
  border: 4px solid #FFF;
  box-shadow: 
    0 4px 0 #357A38,
    0 8px 16px rgba(0,0,0,0.15);
  
  /* 文字 */
  color: white;
  font-size: 24px;
  font-weight: bold;
  text-shadow: 0 2px 0 rgba(0,0,0,0.2);
}
```

### ナビゲーションアイコン

```css
.nav-icon {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: rgba(255,255,255,0.8);
  backdrop-filter: blur(8px);
  border: 2px solid rgba(255,255,255,0.5);
}
```

**半透明で庭の邪魔をしない**

---

## 📱 レスポンシブ対応

### iPhone SE2 (375×667) 最適化

<!-- 2025-01-20 修正: iPhone SE2の正しいセーフエリア値に訂正 -->

**iPhone SE2 デバイス特性（重要）**

| 特性 | iPhone SE2 | 参考: Face ID搭載機 |
|------|-----------|-------------------|
| 画面サイズ | 375×667pt | 390×844pt等 |
| ステータスバー | **20pt** | 47pt |
| ホームインジケータ | **なし（物理ボタン）** | 34pt |
| ノッチ | **なし** | あり |
| 使用可能高さ | **647pt** | 約763pt |

```
┌───────────────────────┐
│        20pt           │ ← ステータスバー（SE2は20pt）
├───────────────────────┤
│                       │
│                       │
│    庭エリア 581pt     │ ← メインコンテンツ（大幅拡大！）
│                       │
│                       │
├───────────────────────┤
│    ナビ 66pt          │
├───────────────────────┤
│  物理ホームボタン(画面外) │ ← 画面に含まない
└───────────────────────┘

※ 計算: 667 - 20(ステータス) - 66(ナビ) = 581pt
※ PWAスタンドアロン時はステータスバーがアプリ外となり、601pt使用可能
```

---

## 📐 iPhone SE2 小画面最適化設計

<!-- 2025-01-20 追加: 小画面特化設計 -->

### 横幅375pxのボタンレイアウト

| 配置パターン | ボタンサイズ | 個数 | 余白計算 |
|-------------|-------------|------|---------|
| 大ボタン2列 | 80×80pt | 2個 | (375 - 80×2) / 3 = 71.6pt |
| 中ボタン3列 | 64×64pt | 3個 | (375 - 64×3) / 4 = 45.75pt |
| 小ボタン4列 | 56×56pt | 4個 | (375 - 56×4) / 5 = 30.2pt |
| アイコン5列 | 48×48pt | 5個 | (375 - 48×5) / 6 = 22.5pt |

**推奨:** ナビは**5アイコンまで**、ツールは**4ボタンまで**

### 縦667pxの空間配分

```
PWAスタンドアロン時（推奨構成）:

  667pt 総高さ
  ─────────────
  ↓ ヘッダー: 0pt（没入型UIのため非表示）
  ─────────────
  ↓
  ↓ 庭エリア: 601pt (90%)  ← 世界に没入！
  ↓
  ─────────────
  ↓ ナビ: 66pt (10%)  ← 最小限のUI
  ─────────────
```

### 指の動線設計（小画面・片手操作向け）

```
親指リーチ範囲（右手持ち）:

┌───────────────────────┐
│ ×   ×   △             │ ← 届きにくい（設定など低頻度）
│                       │
│ △   ○   ○             │
│ ○   ○   ○             │ ← 庭操作エリア
│ ○   ◎   ◎             │
├───────────────────────┤
│ ○   ◎   ◎   ◎   ◎    │ ← ナビ（最も押しやすい）
└───────────────────────┘

◎ = 最適配置  ○ = 良好  △ = 可能  × = 困難
```

**設計ルール:**
1. **頻繁な操作は画面下半分に集中**
2. **右下が最もタップしやすい**（右手親指）
3. **設定など低頻度操作は右上へ**
4. **庭のピンチ/スワイプは画面中央で完結**

### ゲームプレイエリア最大化テクニック

1. **没入型UI**: ヘッダーなし、ナビは半透明オーバーレイ
2. **コンテキスト依存表示**: 操作時のみツール表示
3. **エッジスワイプ**: 画面端スワイプでメニュー出現

### セーフエリア

```css
/* iPhone SE2は safe-area-inset が基本0だが、将来対応のため記述 */
.game-container {
  padding-top: env(safe-area-inset-top, 0);
  padding-bottom: env(safe-area-inset-bottom, 0);
  padding-left: env(safe-area-inset-left, 0);
  padding-right: env(safe-area-inset-right, 0);
}

/* PWAスタンドアロンモード検出 */
@media all and (display-mode: standalone) {
  .game-container {
    /* フルスクリーン活用 */
    height: 100vh;
    height: 100dvh; /* Dynamic viewport height */
  }
}
```

---

## 🔊 サウンドデザイン（改訂）

### 環境音

| 時間帯 | 環境音 |
|--------|--------|
| 朝 | 小鳥のさえずり、風 |
| 昼 | 風、虫の声 |
| 夕方 | ひぐらし |
| 夜 | こおろぎ、ふくろう |

**BGMではなく環境音で「世界にいる」感覚**

### 効果音

| アクション | 音 |
|-----------|-----|
| 水やり | ちゃぽん、さらさら |
| たね植え | ぽん、さくっ |
| 住人の声 | かわいい鳴き声 |
| 成功 | キラキラーン |
| ボーナス | ファンファーレ（短い） |

---

## 📳 触覚フィードバック

| アクション | バイブレーション |
|-----------|-----------------|
| ボタンタップ | 軽く1回 (10ms) |
| たね植え成功 | 2回 (10ms-10ms) |
| 水やり | なし（自然な感覚） |
| ボーナス獲得 | パターン (10-20-10-20-30ms) |
| レア発見 | 強め1回 (30ms) |

---

## ⚠️ 禁止事項（UI編）

| 禁止 | 理由 |
|------|------|
| 全画面ポップアップ | 没入感が切れる |
| 長いローディング | 待てない |
| 複雑なメニュー階層 | 迷子になる |
| 小さい閉じるボタン | 押せない |
| 漢字 | 読めない |
| 赤い警告 | 怖い |
| 暗い画面 | 怖い |
| 唐突な音 | 驚く |

---

## ✅ UIチェックリスト

### 没入感
- [ ] 庭が画面の90%を占めている
- [ ] UIが半透明で邪魔しない
- [ ] 常に何かがアニメーションしている
- [ ] 環境音が流れている

### 操作性
- [ ] 全ボタン48pt以上
- [ ] タップとスワイプだけで操作完結
- [ ] 即座にフィードバック
- [ ] 迷子にならない導線

### 世界観
- [ ] 絵本のような優しいタッチ
- [ ] パステルカラー統一
- [ ] 住人がかわいい
- [ ] 「生きている」感覚

---

**次のドキュメント:** TECH_SPEC.md（更新）


---

## 📝 変更履歴

### 2025-01-20 iPhone SE2セーフエリア修正
- **修正:** ステータスバー 47pt → 20pt（SE2の正しい値）
- **修正:** ホームインジケータ 34pt → なし（物理ホームボタンのため存在しない）
- **修正:** 庭エリア 520pt → 581pt（正しい計算値）
- **追加:** iPhone SE2 デバイス特性表
- **追加:** 375px幅のボタンレイアウト計算表
- **追加:** 指の動線設計（親指リーチ範囲図）
- **追加:** ゲームプレイエリア最大化テクニック
- **追加:** PWAスタンドアロンモード対応CSS
